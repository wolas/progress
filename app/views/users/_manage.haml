#manage_users
  .two_col
    - if object.managers.empty?
      No users assigned to this
      = object.class.to_s.downcase
      yet

    - else
      %table
        - object.users.each do |user|
          %tr
            %td
              %span
                = render :partial => "users/widget", :locals => {:user => user}
                = link_to_remote image_tag('cross.png'), :url => {:controller => 'users', :action => :remove_user, :object_id => object, :object_class => object.class, :user => user}, :update => 'manage_users'

  .two_col{:style => 'padding-left: 20px;'}
    .attribute
      .name Search
      .value
        = text_field_tag :name, nil, :id => :search
        = observe_field :search, :url => { :controller => 'users', :action => :search, :object_id => object.id, :object_class => object.class }, :frequency => 0.25, :update => :users, :with => 'name'

    #users
      - to_add = User.all - object.managers
      - if to_add.empty?
        No one left to be assigned!
      - else
        %table
          - to_add.each do |user|
            %tr
              %td
                %span
                  = render :partial => "users/widget", :locals => {:user => user}
                  = link_to_remote image_tag('accept.png'), :url => {:controller => 'users', :action => :add_user, :object_id => object, :object_class => object.class, :user => user}, :update => 'manage_users'

  .clear
